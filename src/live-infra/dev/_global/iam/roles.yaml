# IAM Roles Configuration
# Variables available: ${name_prefix}, ${account_id}

# Human roles for console/CLI access
${name_prefix}-admin:
  description: "Admin role with full AWS access"
  require_mfa: true
  max_session_duration: 43200  # 12 hours
  managed_policies:
    - AdministratorAccess
  custom_policies:
    - assume-app-role
  allowed_ips: []  # Add IP restrictions here if needed
  eks_access: "admin"  # system:masters group in Kubernetes

${name_prefix}-tester:
  description: "Tester role for Sword Health with read-only access"
  require_mfa: false
  max_session_duration: 14400  # 4 hours
  managed_policies:
    - ReadOnlyAccess
  custom_policies:
    - assume-app-role
  eks_access: "tester"  # read-only-users group in Kubernetes

# Infrastructure automation roles
${name_prefix}-terraform-role:
  description: "Role for Terraform/GitHub Actions automation"
  require_mfa: false
  max_session_duration: 3600  # 1 hour
  trusted_entities:
    - "arn:aws:iam::${account_id}:root"  # Update with GitHub OIDC provider after setup
  managed_policies:
    - PowerUserAccess
  inline_policies:
    iam-limited:
      statements:
        - Effect: "Allow"
          Action:
            - "iam:*"
          Resource:
            - "arn:aws:iam::${account_id}:role/${name_prefix}-*"
            - "arn:aws:iam::${account_id}:policy/${name_prefix}-*"
            - "arn:aws:iam::${account_id}:instance-profile/${name_prefix}-*"
        - Effect: "Deny"
          Action:
            - "iam:CreateAccessKey"
            - "iam:DeleteAccessKey"
          Resource: "*"
